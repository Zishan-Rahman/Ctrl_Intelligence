{% extends 'base_content.html' %}
{% load bootstrap_pagination %}
{% block content %}
<div class="container">
  {% if ratings %}
<h2 class="text-left"><strong>My Book Ratings</strong></h2>
      <h5 class="text-muted">All Previous Book Ratings</h5>
<div class="book-table">
  <input type='text' id='txt_searchall' placeholder="Search for your book ratings..." size="30">&nbsp;
  <div>
    <table id="myTable" class="table table-hover table-borderless">
      <thead>
    <tr>
      <th scope="col"></th>
      <th scope="col">Title</th>
      <th scope="col">Author</th>
      <th scope="col">Publication Year</th>
      <th scope="col">My Rating</th>
    </tr>
  </thead>
  <tbody>
    {% for entry in page_obj %}
    <tr>
      <td><img src="{{ entry.book.medium_url }}" alt="a"></td>
      <td>{{ entry.book.title }}</td>
      <td>{{ entry.book.author }}</td>
      <td>{{ entry.book.pub_year }}</td>
      <td>{{ entry.rating }}</td>
    </tr>
    {% endfor %}
  </tbody>
    </table>
</div>
<div id="pag">
  {% bootstrap_paginate page_obj range=6 previous_label="Previous" next_label="Next" show_first_last="true" %}
</div>

</div>

{% else %}
<div class="mt-5" style="text-align: center;">
     <h5 class="text-muted text-center">You do not have any book ratings</h5>
</div>
{% endif %}
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script>
  $(document).ready(function(){
    $('.fullTable').hide();
    $('#txt_searchall').keyup(function(){
      var search = $(this).val();
      $('#fullTable').show();
      $('#fullTableHeader').hide();
      $('table tbody tr').hide();
      var len = $('table tbody tr:not(.notfound) td:contains("'+search+'")').length;
      if(len > 0){
        $('table tbody tr:not(.notfound) td:contains("'+search+'")').each(function(){
          $(this).closest('tr').show();
          $('#fullTableHeader').show();
          $('#myTable').hide();
          $('#pag').hide();
        });
      }else{
        $('.notfound').show();
      }
      if(search.length == 0){
        $('table tbody tr').show();
        $('#fullTable').hide();
        $('#myTable').show();
        $('#pag').show();
      }
    });
  });
  $.expr[":"].contains = $.expr.createPseudo(function(arg) {
     return function( elem ) {
       return $(elem).text().toUpperCase().indexOf(arg.toUpperCase()) >= 0;
     };
  });
</script>
{% endblock %}
